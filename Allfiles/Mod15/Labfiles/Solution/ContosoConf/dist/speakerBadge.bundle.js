!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/",n(n.s=15)}({15:function(e,t,n){"use strict";var a=n(16),r=document.querySelector(".badge");new a.SpeakerBadgePage(r)},16:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpeakerBadgePage=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(17);t.SpeakerBadgePage=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=t.querySelector("canvas"),this.busyElement=t.querySelector(".busy"),this.speakerId=this.canvas.getAttribute("data-speaker-id"),this.speakerName=this.canvas.getAttribute("data-speaker-name"),this.canvas.addEventListener("dragover",this.handleDragOver.bind(this)),this.canvas.addEventListener("drop",this.handleDrop.bind(this)),this.drawBadge()}return a(e,[{key:"handleDragOver",value:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}},{key:"handleDrop",value:function(e){var t=this;e.stopPropagation(),e.preventDefault();var n=e.dataTransfer.files;if(0!=n.length){var a=n[0];this.isImageType(a.type)?(this.busy(),this.readFile(a).then(function(e){return t.loadImage(e)}).then(function(e){return(0,r.grayscaleImage)(e)}).then(function(e){return t.notBusy(e)})):alert("Please drop an image file.")}}},{key:"drawBadge",value:function(e){this.context=this.canvas.getContext("2d"),this.drawBackground(),this.drawTopText(),this.drawSpeakerName(),e?this.drawSpeakerImage(e):this.drawImagePlaceholder(),this.drawBarCode(this.speakerId)}},{key:"drawBackground",value:function(){this.context.fillStyle="white",this.context.fillRect(0,0,this.canvas.width,this.canvas.height)}},{key:"drawSpeakerImage",value:function(e){var t=Math.min(e.width,e.height),n=e.width/2-t/2,a=e.height/2-t/2;this.context.drawImage(e,n,a,t,t,20,20,160,160)}},{key:"drawImagePlaceholder",value:function(){this.context.strokeStyle="2px #888",this.context.strokeRect(20,20,160,160),this.context.font="12px sans-serif",this.context.textBaseline="middle",this.context.textAlign="center",this.context.fillStyle="black",this.context.fillText("Drag your profile photo here",100,100)}},{key:"drawTopText",value:function(){this.context.font="20px sans-serif",this.context.fillStyle="black",this.context.textBaseline="top",this.context.textAlign="left",this.context.fillText("ContosoConf 2013 Speaker:",200,20)}},{key:"drawSpeakerName",value:function(){this.context.font="40px sans-serif",this.context.fillStyle="black",this.context.textBaseline="top",this.context.textAlign="left",this.context.fillText(this.speakerName,200,60)}},{key:"drawBarCode",value:function(e){e="*"+e+"*";for(var t={0:"bwbWBwBwb",1:"BwbWbwbwB",2:"bwBWbwbwB",3:"BwBWbwbwb",4:"bwbWBwbwB",5:"BwbWBwbwb",6:"bwBWBwbwb",7:"bwbWbwBwB",8:"BwbWbwBwb",9:"bwBWbwBwb","*":"bWbwBwBwb"},n=200,a=0;a<e.length;a++){for(var r=t[e[a]],i=0;i<r.length;i++){this.context.fillStyle=i%2==0?"black":"white",r.charCodeAt(i)<91?(this.context.fillRect(n,140,6,40),n+=6):(this.context.fillRect(n,140,2,40),n+=2)}a<e.length-1&&(this.context.fillStyle="white",this.context.fillRect(n,140,2,40),n+=2)}}},{key:"isImageType",value:function(e){return 0===["image/jpeg","image/jpg","image/png"].indexOf(e)}},{key:"readFile",value:function(e){return new Promise(function(t,n){var a=new FileReader;a.onload=function(e){var n=e.target.result;t([n])},a.readAsDataURL(e)})}},{key:"loadImage",value:function(e){return new Promise(function(t,n){var a=new Image;a.onload=function(){t(a)},a.src=e})}},{key:"busy",value:function(){this.busyElement.style.display="block"}},{key:"notBusy",value:function(){this.busyElement.style.display="none"}}]),e}()},17:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.grayscaleImage=function(e){return new Promise(function(t,n){var a=function(e){var t=document.createElement("canvas");return t.setAttribute("width",e.width),t.setAttribute("height",e.height),t}(e),r=a.getContext("2d"),i=function(e,t){return e.drawImage(t,0,0),e.getImageData(0,0,t.width,t.height)}(r,e),o=new Worker("/scripts/grayscale-worker.js");o.addEventListener("message",function(e){r.clearRect(0,0,a.width,a.height),r.putImageData(i,0,0),t([a])}.bind(this)),o.postMessage(i)})};n(18)},18:function(e,t,n){"use strict";function a(e,t){var n=.34*e[t]+.5*e[t+1]+.16*e[t+2];e[t]=n,e[t+1]=n,e[t+2]=n}addEventListener("message",function(e){for(var t=e.data,n=t.data,r=0;r<n.length;r+=4)a(n,r);postMessage({done:t})})}});
//# sourceMappingURL=speakerBadge.bundle.js.map